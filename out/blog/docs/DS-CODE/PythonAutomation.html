<!DOCTYPE html>

<html lang="zh-CN"  class=" language_zh ">


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="keywords" content="">
    
    
    <meta name="description" content="">
    
    <meta name="generator" content="teedoc">
    <meta name="theme" content="teedoc-plugin-theme-default">
    
        
        <meta name="markdown-generator" content="teedoc-plugin-markdown-parser">
        
        <script>
MathJax = {"loader": {"load": ["output/svg"]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "svg": {"fontCache": "global"}};
</script>
        
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
        <script src="/static/js/theme_default/pre_main.js"></script>
        
        <link rel="stylesheet" href="/static/css/theme_default/prism.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/viewer.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/dark.css" type="text/css"/>
        
        <link rel="stylesheet" href="/static/css/theme_default/light.css" type="text/css"/>
        
        <script src="/static/js/theme_default/jquery.min.js"></script>
        
        <script src="/static/js/theme_default/split.js"></script>
        
        <link rel="stylesheet" href="/static/css/search/style.css" type="text/css"/>
        
        <meta name="blog-generator" content="teedoc-plugin-blog">
        
        <link rel="stylesheet" href="/static/css/custom.css" type="text/css"/>
        
    
    
    <title>PythonAutomation  - Knowledge Base</title>
    
    <script type="text/javascript">js_vars = {}</script>
    <script type="text/javascript">metadata = {"tags": [], "date": null, "update": [], "ts": 0, "author": "", "brief": "", "cover": ""}</script>
</head>


<body class="type_doc">
    
    <div id="navbar">
        <div id="navbar_menu">
            <a class="site_title" href="/">
                
                    <img class="site_logo" src="/static/image/logo.png" alt="my_site logo">
                
                
                    <h2>KnowledgeBase</h2>
                
        </a>
            <a id="navbar_menu_btn"></a>
        </div>
        <div id="navbar_items">
            <div>
                <ul id="nav_left">
<li class=""><a  href="/get_started/zh/">主页</a></li>
<li class="active"><a  href="/blog/">博客</a></li>
</ul>

            </div>
            <div>
                <ul id="nav_right">
<li class=""><a target="_blank" href="https://github.com/hsucode">github</a></li>
</ul>

                <ul class="nav_plugins"><li><a id="themes" class="light"></a></li></ul><ul class="nav_plugins"><li><a id="search"><span class="icon"></span><span class="placeholder">搜索</span>
                            <div id="search_hints">
                                <span id="search_input_hint">输入关键词，多关键词空格隔开</span>
                                <span id="search_loading_hint">正在加载，请稍候。。。</span>
                                <span id="search_download_err_hint">下载文件失败，请刷新重试或检查网络</span>
                                <span id="search_other_docs_result_hint">来自其它文档的结果</span>
                                <span id="search_curr_doc_result_hint">当前文档搜索结果</span>
                            </div></a></li></ul>
            </div>
        </div>
    </div>
    
    <div id="wrapper">
        <div id="sidebar_wrapper">
            <div id="sidebar">
                <div id="sidebar_title">
                    
                </div>
                <ul class="">
</ul>

            </div>
        </div>
        <div id="article">
            <div id="menu_wrapper">
                <div id="menu">
                </div>
            </div>
            <div id="content_wrapper">
                <div id="content_body">
                    <div id="article_head">
                        <div id="article_title">
                            
                            <h1>PythonAutomation </h1>
                            
                        </div>
                        <div id="article_tags">
                            <ul>
                            
                            </ul>
                        </div>
                        <div id="article_info">
                        <div id="article_info_left">
                            <span class="article_author">
                                
                            </span>
                            
                                <span class="article_date" title="最后修改日期： 2022-10-21">
                                    2022-10-21
                                </span>
                            
                        </div>
                        <div id="article_info_right">
                            
                            <div id="source_link">
                                <a href="git@github.com:hsucode/xusblog.github.io.git/blog/docs/DS-CODE/PythonAutomation.md" target="_blank">
                                    编辑本页
                                </a>
                            </div>
                            
                        </div>
                        </div>
                    </div>
                    <div id="article_tools">
                        <span></span>
                        <span id="toc_btn"></span>
                    </div>
                    <div id="update_history">
                        
                    </div>
                    <div id="article_content">
                        
                            <span id="blog_start"></span><p><img src="PythonAutomation%5C%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20220429094807.png" alt="" /></p>
<p>Introduction<br />
Python has become one of the most popular scripting language in Science, Technology, Engineering and Mathematics disciplines.<br />
Python is a very complete, performant and easy to use programing language. It provides many discipline-specific libraries that can be readily referenced by users.<br />
Providing python scripting capabilities as a complement to our Enterprise Knowledge Language (EKL) scripting strengthens design automation capabilities on the 3DEXPERIENCE Platform.<br />
Finally with Python, the access to scripting capabilities is easier and available to a larger audience democratizing design automation.<br />
A simple demonstration illustrating some unique capabilities offered by the python language for design automation scenarios.</p>
<p>Aim<br />
The aim of the python editor is to offer access to:</p>
<p>the standard Python modules (e.g. abc, collections, tkinter)<br />
an EKL binding managing:<br />
the automatic loading of the suitable EKL packages<br />
the interoperability with EKL types<br />
an access to all EKL functions and methods<br />
interactions with the sessions features (relations and geometries in the specification tree, PLM objects)<br />
extensions to external packages (e.g. Numpy, Maplotlib)<br />
the capability to be invoked from EKL.</p>
<p>Syntax<br />
Inside the Python editor, the syntax to use is the Python syntax:</p>
<p>comment (# and not // or /* */)<br />
indentation is used to define blocks for conditions or loop<br />
no variable declaration<br />
The EKL native Types and Functions are integrated in the python syntax thanks to the EKL binding. You can find more information in dedicated sections on this page.</p>
<p>Sample<br />
The Python script below is computing the factorial:</p>
<p><img src="PythonAutomation%5C2022-04-29-13-10-46.png" alt="" /></p>
<p>EKL Variables in Python<br />
The EKL language is a static and strongly typed language. All the variables have to be declared by using the keyword let.</p>
<p>However, as Python is dynamically typed language, variable declaration is not necessary.</p>
<p>The EKL script below is working with a Pad as input stored in the variable named myPad.</p>
<p><img src="PythonAutomation%5C2022-04-29-13-11-29.png" alt="" /></p>
<p>Its Python counterpart is :</p>
<p><img src="PythonAutomation%5C2022-04-29-13-11-38.png" alt="" /></p>
<p>EKL Types in Python<br />
Python EKL type<br />
The EKL language is based on two dictionaries: a type and a function dictionary. To generate their definition inside Python, the binding has kept this architecture and has created two Python namespaces: first one, ekl, stores all functions and the second one, ekl.types, stores all type definitions.</p>
<p>Let XXX be an EKL type, the associated Python object ekl.types.XXX is a class with the same inheritance that the EKL types have and with its EKL attributes and methods.</p>
<p>The Python type of the Python object ekl.type.XXX is: ‹class ekl.XXX›</p>
<p>Specific types<br />
Basic types</p>
<p>The basic types are implicitly converted. Boolean, Integer, Real, String can be used as arguments of the EKL methods/functions without converting them in their EKL version.</p>
<p>Dimensional types</p>
<p>The dimension values have a specific construction. All the types of dimensions available in EKL as Length, Angle, Area, Volume are also available in Python thanks to the binding.</p>
<p>To illustrate, you will find below a EKL script as example:</p>
<p><img src="PythonAutomation%5C2022-04-29-13-12-00.png" alt="" /></p>
<p>and its Python counterpart:</p>
<p><img src="PythonAutomation%5C2022-04-29-13-12-07.png" alt="" /></p>
<p>Care must be taken for all EKL Functions/Methods that use dimensions as arguments as the units are not automatically detected as they are in EKL. For instance, the following EKL script:</p>
<p><img src="PythonAutomation%5C2022-04-29-13-12-18.png" alt="" /></p>
<p>has to be translated into Python either as follows:</p>
<p><img src="PythonAutomation%5C2022-04-29-13-12-32.png" alt="" /><br />
or as follows:</p>
<p><img src="PythonAutomation%5C2022-04-29-13-12-51.png" alt="" /></p>
<p>List</p>
<p>The Python standard library provides several types of collections : list, array, tuple, dictionary.</p>
<p>On the other hand, the EKL language provides an unique collection called List that can handle lists, arrays and structures.</p>
<p>All the methods available in EKL to fill and manipulate collections such as GetItem, IndexOf were bound in Python as in the following Python script:</p>
<p><img src="PythonAutomation%5C2022-04-29-13-13-05.png" alt="" /></p>
<p>EKL Functions/Methods in Python<br />
To understand how to call the function, first we need to know the difference between a function and a method:</p>
<p>A method is applied to the objects of the class they belong to. EKL and Python syntax are the same in that context<br />
A function is not associated with any object and can be invoked just with its name. The EKL binding stores the EKL functions in the namespace ekl. So in the Python editor, the name of the EKL has to be preceded by the prefix &quot;ekl.&quot;.</p>
<p>All the functions/methods available in EKL are available in the Python editor, like Message, Notify, GetEditorRoots, etc.</p>
<p>To illustrate, you will find below an EKL script with as input a Point stored in the variable named myPoint.</p>
<p><img src="PythonAutomation%5C2022-04-29-13-13-30.png" alt="" /></p>
<p>and its Python counterpart :</p>
<p><img src="PythonAutomation%5C2022-04-29-13-13-40.png" alt="" /></p>
<p>New Python specific APIs<br />
New API for the geometry validity: is_null<br />
In the EKL actions, the user regularly navigate into product structure to retrieve a particular instance.</p>
<p>In that case, the user has to check at each step the validity of the returned object.</p>
<p>In the EKL language, the validity is performed by the following test : obj &lt;&gt; NULL</p>
<p>Due to the binding ,this check is not valid in Python. Instead a new function called is_null has been added to compensate it.</p>
<p>In the following example, the Param rep is specified as an VPMReference.</p>
<p><img src="PythonAutomation%5C2022-04-29-13-13-50.png" alt="" /></p>
<p>and its Python counterpart :</p>
<p><img src="PythonAutomation%5C2022-04-29-13-13-58.png" alt="" /></p>
<p>New API for the geometry creation: build_from<br />
To create a geometry inside the part, the associated script can be split as follows:</p>
<p>declare a variable with type of the new geometry<br />
create an occurence of the object<br />
instantiate it via affecting the occurence to the new variable</p>
<p>In the EKL language, the instantiation is performed implicitly during the variable affectation.</p>
<p>In Python, the user has to define it explicitly by the method build_from.</p>
<p>In the following EKL script, the Param geoSet is specified as a Feature.</p>
<p><img src="PythonAutomation%5C2022-04-29-13-14-07.png" alt="" /></p>
<p>Its Python counterpart is :</p>
<p><img src="PythonAutomation%5C2022-04-29-13-14-17.png" alt="" /></p>
<p>New API for the type import: import_type<br />
Inside the Python editor, the EKL binding manages the automatic loading of the suitable EKL packages.</p>
<p>In some cases though, there may be ambiguities. To solve them, the user can explicitly load the associated library of a type by using the new function import_type.</p>
<p>The type and its associated EKL package will be loaded and defined in Python namespaces ekl and ekl.types.</p>
<p><img src="PythonAutomation%5C2022-04-29-13-14-26.png" alt="" /></p>
<p>Execution from an EKL Action<br />
In the relations as the Actions/Reactions, the execution of a Python script can be implemented by applying the Run operator and specifying any input or output arguments to the Python script in the EKL Relation. In that case, the execution of the relation launches the execution of the included Python script. Notice that this is not possible from a VB script. In contrast, EKL or VB scripts cannot be run from a Python script.</p>
<p>Let &quot;Python Script.1&quot; be a Python Script aggregated to the Relation Set &quot;Relations&quot;</p>
<p><img src="PythonAutomation%5C2022-04-29-13-14-35.png" alt="" /></p>
<p>External Python package<br />
To use external Python libraries the user has to:</p>
<p>Allow referencing external libs<br />
Specify the location of the file directory in the python scripts section of the preference pages : 3D Modeling &gt; Multidiscipline Automated Engineering &gt; Basics<br />
The Python script below is plotting a Sine wave using Matplotlib and Numpy.</p>
<p><img src="PythonAutomation%5C2022-04-29-13-14-48.png" alt="" /></p>
<p><img src="PythonAutomation%5C2022-04-29-13-15-06.png" alt="" /></p>
<p>Quick notes on installing external libs<br />
One needs to take care to install the compatible version of the library with the Python interpreter provided in 3DEXPERIENCE. To know the current python version, use print(sys.version) in the editor.<br />
To install Python packages into a specified directory using pip install, the -t, --target option can be used. By default this will not replace existing files/folders in the specified directory. Add the -U, --upgrade option to replace existing packages with new versions.</p>
<p>Detailed instructions<br />
(Thanks to @Thomas PERRET ​​​​​​​&amp; @Guillaume VIRY ​​​​​​​for this information.)</p>
<p>Prerequisite<br />
In order to install additional Python packages to be used in scripts, you will need to have a separate Python environment. The one coming with the 3DEXPERIENCE is partial and does not come with all the required tools.</p>
<p>There is no real constraint, the environment can be installed via the Microsoft Store, the official Python installer, or a tier Python distribution like Anaconda or Miniforge.</p>
<p>From a terminal (cmd.exe, or PowerShell), you need to launch the pip command, bundled with Python.</p>
<p>Here we will for instance install the “pandas” package in a specific folder.</p>
<p>If your Python environment is 3.7.x (recommended), you can do:</p>
<p>“path/to/pip.exe” install pandas –t “path/to/my/folder”<br />
If it has a different version (like 3.10.x), you need to specify the target intended version (3.7 in R2022x FD01), and probably force binary packages</p>
<p>“path/to/pip.exe” install pandas –t “path/to/my/folder” –-python-version “3.7” --only-binary=:all:<br />
You will see that the requested package and its dependencies have been installed in your folder.</p>
<p>Extra Tips<br />
To check the python version of CATIA (3.7.9 as of 2022x FD01), run a Python Script in Engineering Rules Capture with:<br />
 print(sys.version)<br />
If you already have a Python 3.7.x environment setup on your device, it is probably a good idea to use its external package directory<br />
Disclaimer<br />
If you change of device, your python scripts may not work anymore. You will need to install or copy the necessary packages.</p>
<p>Temporary Limitations<br />
Even though, the EKL integration to Python is almost complete in R2022x FD01, two restrictions exist:</p>
<p>the access to the Local and Data Setup resources<br />
the EKL variable initialization in Python.<br />
Both will be fixed in FD02.</p>
<p>Limitation 1 :</p>
<p>In FD01, the vast majority of EKL functions are integrated to Python (Geometry/ Measure/Search functions, Message and Notify functionalities, Product Structure/Parameter management). However, aspects related to Local and Data Setup resources are not yet integrated. i.e. the following capabilties are not available yet :</p>
<p>add Python Script features to local resource tables or to Data Setup tables.<br />
have access from another script or action to a Python Script included in a local resource table or to a Data Setup table.<br />
have access from a Python script to objects from local resource tables or Data Setup tables.<br />
For example, Template Instantiation from a python script will not be possible in FD01.</p>
<p><img src="PythonAutomation%5C2022-04-29-13-15-41.png" alt="" /></p>
<p>Limitation 2 :</p>
<p>In Python, a variable doesn’t exist unless it has a value, so the variable is only created the first time a value is assigned to it.</p>
<p>In FD01, unless you know how to explicitly initialize an EKL object, you can’t create this variable and use it as an argument in a function later.</p>
<p>From FD02, if the user doesn’t want or know how to preinitialize its value, the can use the keyword None.</p>
<p>In the following example, the input ref is specified as an VPMReference.</p>
<p><img src="PythonAutomation%5C2022-04-29-13-15-51.png" alt="" /></p>
<p>To help users implement Python Scripts with EKL objects / APIs, in R2022x FD02, a Getting Started guide and the EKL Language Browser will be available directly from the Python Editor.</p>
<p>EKL scripts and their equivalents in Python<br />
For reference, here are some basic examples of EKL scripts for different use cases and their equivalent Python versions.</p>
<p>Basic Object Search and Attribute Modification</p>
<p><img src="PythonAutomation%5C2022-04-29-13-16-02.png" alt="" /></p>
<p>Create and Remove Instances</p>
<p><img src="PythonAutomation%5C2022-04-29-13-16-09.png" alt="" /></p>
<p>Get and Set Parameter values<br />
<img src="PythonAutomation%5C2022-04-29-13-16-18.png" alt="" /></p>
<p>Create Geometry</p>
<p><img src="PythonAutomation%5C2022-04-29-13-16-26.png" alt="" /></p>
<p>Python Learning Resources<br />
Python is a hugely popular language and it is very easy to find learning resources and answers to many questions online. It is also possible to find many courses like on LinkedIn Learning, Udemy, etc.</p>
<p>The Python Essential Training course by Bill Weinman is a good one to quickly get familiar with the language.<br />
&quot;Think Python&quot; - well written and pretty thorough in covering different aspects of Python. The PDF is freely available here <a href="https://greenteapress.com/thinkpython/thinkpython.pdf"  target="_blank">Think Python</a> .</p>

                        
                    </div>
                </div>
                <div id="previous_next">
                    <div id="previous">
                        
                    </div>
                    <div id="next">
                        
                    </div>
                </div>
                <div id="comments-container"></div>
            </div>
            <div id="toc_wrapper">
                <div id="toc">
                    <div id="toc_content">
                            
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a id="to_top" href="#"></a>
    <div id="doc_footer">
        <div id="footer">
            <div id="footer_top">
                <ul>
<li><a></a>
</li>
<li><a>源码</a><ul><li><a target="_blank" href="https://github.com/neutree/teedoc">github</a></li>
<li><a target="_blank" href="https://gitee.com/teedoc/teedoc">gitee</a></li>
</ul>
</li>
</ul>

            </div>
            <div id="footer_bottom">
                <ul>
<li><a></a>
</li>
</ul>

            </div>
        </div>
    </div>
    
        <script src="/teedoc-plugin-markdown-parser/mermaid.min.js"></script>
    
        <script>mermaid.initialize({startOnLoad:true});</script>
    
        <script src="/static/js/theme_default/tocbot.min.js"></script>
    
        <script src="/static/js/theme_default/main.js"></script>
    
        <script src="/static/js/theme_default/viewer.min.js"></script>
    
        <script src="/static/css/theme_default/prism.min.js"></script>
    
        <script src="/static/js/search/search_main.js"></script>
    
        <script src="/static/js/plugin_blog/main.js"></script>
    
        <script src="/static/js/custom.js"></script>
    
        <script type="text/javascript" src="/static/js/live.js"></script>
    
</body>

</html>